name: Fotovoltaika - Automatick칠 ovl치d치n칤 rel칠

on:
  schedule:
    # Spou코t캩t ka쬯ou hodinu ve 2. minut캩 (UTC 캜as)
    # Pozn치mka: 캛esk칳 캜as je UTC+1 (zimn칤) nebo UTC+2 (letn칤)
    # Tak쬰 1:02 UTC = 2:02 nebo 3:02 캜esk칠ho 캜asu
    - cron: '2 * * * *'
  workflow_dispatch:  # Umo쮄갓je manu치ln칤 spu코t캩n칤

jobs:
  control-relay:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout k칩d
      uses: actions/checkout@v4
      
    - name: Nastaven칤 Pythonu
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Instalace z치vislost칤
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: Spu코t캩n칤 skriptu s 캜asovou z칩nou
      env:
        SHELLY_DEVICE_ID: ${{ secrets.SHELLY_DEVICE_ID }}
        SHELLY_AUTH_KEY: ${{ secrets.SHELLY_AUTH_KEY }}
        TZ: Europe/Prague  # Nastaven칤 캜esk칠 캜asov칠 z칩ny
      run: |
        echo "游뎷 Aktu치ln칤 캜as (UTC): $(date -u)"
        echo "游뎷 Aktu치ln칤 캜as (캜esk칳): $(TZ=Europe/Prague date)"
        echo "游뎷 캛as spu코t캩n칤 GitHub Actions: $(date)"
        python main.py
        
    - name: Ulo쬰n칤 log콢
      if: always()
      run: |
        echo "游늵 Workflow dokon캜en v: $(date)"
        echo "游늵 캛asov치 z칩na: $(date +%Z)"
